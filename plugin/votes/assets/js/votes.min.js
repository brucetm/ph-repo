var Votes;function votes_after_button_submit(t,e,o,a){}function votes_after_initial_load(t){}(Votes=Votes||{}).Utilities=function(){var t=this,e=jQuery;t.isVote=function(o,t){var a=!1;return e.each(t,function(t,e){e.post_id===parseInt(o)&&(a=!0),parseInt(e.post_id)===o&&(a=!0)}),a},t.objectLength=function(t){var e,o=0;for(e in t)t.hasOwnProperty(e)&&o++;return o},t.siteIndex=function(t){for(var e=0;e<Votes.userVotes.length;e++)if(Votes.userVotes[e].site_id===parseInt(t))return e},t.getThumbnail=function(t,e){var o=t.thumbnails;if(void 0===o||0==o.length)return!1;var a=o[e];return void 0!==a&&(a||!1)}},(Votes=Votes||{}).Formatter=function(){var s=jQuery;this.addVoteCount=function(t,e){return Votes.jsData.button_options.include_count?(e<=0&&(e=0),t+=' <span class="simplevote-button-count">'+e+"</span>"):t},this.decrementAllCounts=function(){for(var t=s(".simplevote-button.active.has-count"),e=0;e<t.length;e++){var o=s(t)[e],a=s(o).find(".simplevote-button-count"),i=s(a).text()-1;s(o).attr("data-votecount",i)}}},(Votes=Votes||{}).ButtonOptionsFormatter=function(){var s=this,n=jQuery;s.options=Votes.jsData.button_options,s.formatter=new Votes.Formatter,s.format=function(t,e){s.options.custom_colors&&s.colors(t,e),s.html(t,e)},s.html=function(t,e){var o=n(t).attr("data-votecount"),a=s.options.button_type,i="";return"custom"===s.options.button_type?(e&&n(t).html(s.formatter.addVoteCount(Votes.jsData.voted,o)),e||n(t).html(s.formatter.addVoteCount(Votes.jsData.vote,o)),s.applyIconColor(t,e),void s.applyCountColor(t,e)):e?(i+='<i class="'+a.icon_class+'"></i> ',i+=a.state_active,void n(t).html(s.formatter.addVoteCount(i,o))):(i+='<i class="'+a.icon_class+'"></i> ',i+=a.state_default,n(t).html(s.formatter.addVoteCount(i,o)),s.applyIconColor(t,e),void s.applyCountColor(t,e))},s.colors=function(t,e){if(s.options.custom_colors){var o;if(e)return(o=s.options.active).background_active&&n(t).css("background-color",o.background_active),o.border_active&&n(t).css("border-color",o.border_active),void(o.text_active&&n(t).css("color",o.text_active));(o=s.options.default).background_default&&n(t).css("background-color",o.background_default),o.border_default&&n(t).css("border-color",o.border_default),o.text_default&&n(t).css("color",o.text_default),s.boxShadow(t)}},s.boxShadow=function(t){s.options.box_shadow||(n(t).css("box-shadow","none"),n(t).css("-webkit-box-shadow","none"),n(t).css("-moz-box-shadow","none"))},s.applyIconColor=function(t,e){s.options.custom_colors&&(e&&s.options.active.icon_active&&n(t).find("i").css("color",s.options.active.icon_active),!e&&s.options.default.icon_default&&n(t).find("i").css("color",s.options.default.icon_default))},s.applyCountColor=function(t,e){s.options.custom_colors&&(e&&s.options.active.count_active?n(t).find(Votes.selectors.count).css("color",s.options.active.count_active):!e&&s.options.default.count_default&&n(t).find(Votes.selectors.count).css("color",s.options.default.count_default))}},(Votes=Votes||{}).UserVotes=function(){var e=this,o=jQuery;return e.initialLoad=!1,e.bindEvents=function(){o(window).on("load",function(){e.initialLoad=!0,e.getVotes()})},e.getVotes=function(){o.ajax({url:Votes.jsData.ajaxurl,type:"POST",datatype:"json",data:{action:Votes.formActions.votesarray},success:function(t){Votes.jsData.dev_mode&&(console.log("The current user votes were successfully loaded."),console.log(t)),Votes.userVotes=t.votes,o(document).trigger("votes-user-votes-loaded",[t.votes,e.initialLoad]),o(document).trigger("votes-update-all-buttons"),e.initialLoad&&votes_after_initial_load(Votes.userVotes)},error:function(t){Votes.jsData.dev_mode&&(console.log("The was an error loading the user votes."),console.log(t))}})},e.bindEvents()},(Votes=Votes||{}).Clear=function(){var i=this,s=jQuery;return i.activeButton,i.utilities=new Votes.Utilities,i.formatter=new Votes.Formatter,i.bindEvents=function(){s(document).on("click",Votes.selectors.clear_button,function(t){t.preventDefault(),i.activeButton=s(this),i.clearVotes()}),s(document).on("votes-updated-single",function(){i.updateClearButtons()}),s(document).on("votes-user-votes-loaded",function(){i.updateClearButtons()})},i.clearVotes=function(){i.loading(!0);var e=s(i.activeButton).attr("data-siteid");s.ajax({url:Votes.jsData.ajaxurl,type:"post",datatype:"json",data:{action:Votes.formActions.clearall,siteid:e},success:function(t){Votes.jsData.dev_mode&&(console.log("Votes list successfully cleared."),console.log(t)),Votes.userVotes=t.votes,i.formatter.decrementAllCounts(),i.loading(!1),i.clearSiteVotes(e),s(document).trigger("votes-cleared",[i.activeButton,t.old_votes]),s(document).trigger("votes-update-all-buttons")},error:function(t){Votes.jsData.dev_mode&&(console.log("There was an error clearing the votes list."),console.log(t))}})},i.loading=function(t){if(t)return s(i.activeButton).addClass(Votes.cssClasses.loading),void s(i.activeButton).attr("disabled","disabled");s(i.activeButton).removeClass(Votes.cssClasses.loading)},i.updateClearButtons=function(){for(var t,e,o=0;o<s(Votes.selectors.clear_button).length;o++){t=s(Votes.selectors.clear_button)[o],e=s(t).attr("data-siteid");for(var a=0;a<Votes.userVotes.length;a++)Votes.userVotes[a].site_id===parseInt(e)&&(0<i.utilities.objectLength(Votes.userVotes[a].posts)?s(t).attr("disabled",!1):s(t).attr("disabled","disabled"))}},i.clearSiteVotes=function(o){s.each(Votes.userVotes,function(t,e){this.site_id===parseInt(o)&&(Votes.userVotes[t].posts={})})},i.bindEvents()},(Votes=Votes||{}).Lists=function(){var u=this,v=jQuery;return u.utilities=new Votes.Utilities,u.buttonFormatter=new Votes.ButtonOptionsFormatter,u.bindEvents=function(){v(document).on("votes-update-all-lists",function(){u.updateAllLists()}),v(document).on("votes-updated-single",function(){u.updateAllLists()}),v(document).on("votes-cleared",function(){u.updateAllLists()}),v(document).on("votes-user-votes-loaded",function(){u.updateAllLists()})},u.updateAllLists=function(){if(void 0!==Votes.userVotes)for(var t=0;t<Votes.userVotes.length;t++)for(var e=v(Votes.selectors.list+'[data-siteid="'+Votes.userVotes[t].site_id+'"]'),o=0;o<v(e).length;o++){var a=v(e)[o];u.updateSingleList(a)}},u.updateSingleList=function(o){var t=v(o).attr("data-userid"),e=v(o).attr("data-siteid"),a=v(o).attr("data-includelinks"),i=v(o).attr("data-includebuttons"),s=v(o).attr("data-includethumbnails"),n=v(o).attr("data-thumbnailsize"),r=v(o).attr("data-includeexcerpts"),c=v(o).attr("data-posttypes"),d=v(o).attr("data-novotestext");v.ajax({url:Votes.jsData.ajaxurl,type:"post",dataType:"json",data:{action:Votes.formActions.votelist,userid:t,siteid:e,include_links:a,include_buttons:i,include_thumbnails:s,thumbnail_size:n,include_excerpt:r,no_votes:d,post_types:c},success:function(t){Votes.jsData.dev_mode&&(console.log("Votes list successfully retrieved."),console.log(v(o)),console.log(t));var e=v(t.list);v(o).replaceWith(e),u.removeButtonLoading(e),v(document).trigger("votes-list-updated",[e])},error:function(t){Votes.jsData.dev_mode&&(console.log("There was an error updating the list."),console.log(o),console.log(t))}})},u.removeButtonLoading=function(t){var e=v(t).find(Votes.selectors.button);v.each(e,function(){u.buttonFormatter.format(v(this),!1),v(this).removeClass(Votes.cssClasses.active),v(this).removeClass(Votes.cssClasses.loading)})},u.removeInvalidListItems=function(t,a){var e=v(t).find("li[data-postid]");v.each(e,function(t,e){var o=v(this).attr("data-postid");u.utilities.isVote(o,a)||v(this).remove()})},u.bindEvents()},(Votes=Votes||{}).Button=function(){var e=this,o=jQuery;return e.activeButton,e.allButtons,e.authenticated=!0,e.formatter=new Votes.Formatter,e.data={},e.bindEvents=function(){o(document).on("click",Votes.selectors.button,function(t){t.preventDefault(),e.activeButton=o(this),e.setAllButtons(),e.submitVote()})},e.setAllButtons=function(){var t=o(e.activeButton).attr("data-postid");e.allButtons=o('button[data-postid="'+t+'"]')},e.setData=function(){e.data.post_id=o(e.activeButton).attr("data-postid"),e.data.site_id=o(e.activeButton).attr("data-siteid"),e.data.status=o(e.activeButton).hasClass("active")?"inactive":"active";var t=o(e.activeButton).attr("data-user-consent-accepted");e.data.user_consent_accepted=void 0!==t&&""!==t},e.submitVote=function(){e.loading(!0),e.setData();var t={action:Votes.formActions.vote,postid:e.data.post_id,siteid:e.data.site_id,status:e.data.status,user_consent_accepted:e.data.user_consent_accepted};o.ajax({url:Votes.jsData.ajaxurl,type:"post",dataType:"json",data:t,success:function(t){return Votes.jsData.dev_mode&&(console.log("The vote was successfully saved."),console.log(t)),"unauthenticated"===t.status?(Votes.authenticated=!1,e.loading(!1),e.data.status="inactive",o(document).trigger("votes-update-all-buttons"),void o(document).trigger("votes-require-authentication",[e.data])):"consent_required"===t.status?(e.loading(!1),void o(document).trigger("votes-require-consent",[t,e.data,e.activeButton])):(Votes.userVotes=t.votes,e.loading(!1),e.resetButtons(),o(document).trigger("votes-updated-single",[t.votes,e.data.post_id,e.data.site_id,e.data.status]),o(document).trigger("votes-update-all-buttons"),void votes_after_button_submit(t.votes,e.data.post_id,e.data.site_id,e.data.status))},error:function(t){Votes.jsData.dev_mode&&(console.log("There was an error saving the vote."),console.log(t))}})},e.resetButtons=function(){var t=parseInt(o(e.activeButton).attr("data-votecount"));o.each(e.allButtons,function(){if("inactive"===e.data.status)return t<=0&&(t=1),o(this).removeClass(Votes.cssClasses.active),o(this).attr("data-votecount",t-1),void o(this).find(Votes.selectors.count).text(t-1);o(this).addClass(Votes.cssClasses.active),o(this).attr("data-votecount",t+1),o(this).find(Votes.selectors.count).text(t+1)})},e.loading=function(t){t?o.each(e.allButtons,function(){o(this).attr("disabled","disabled"),o(this).addClass(Votes.cssClasses.loading),o(this).html(e.addLoadingIndication())}):o.each(e.allButtons,function(){o(this).attr("disabled",!1),o(this).removeClass(Votes.cssClasses.loading)})},e.addLoadingIndication=function(t){return"1"!==Votes.jsData.indicate_loading?t:"active"===e.data.status?Votes.jsData.loading_text+Votes.jsData.loading_image_active:Votes.jsData.loading_text+Votes.jsData.loading_image},e.bindEvents()},(Votes=Votes||{}).ButtonUpdater=function(){var a=this,i=jQuery;return a.utilities=new Votes.Utilities,a.formatter=new Votes.Formatter,a.buttonFormatter=new Votes.ButtonOptionsFormatter,a.activeButton,a.data={},a.bindEvents=function(){i(document).on("votes-update-all-buttons",function(){a.updateAllButtons()}),i(document).on("votes-list-updated",function(t,e){a.updateAllButtons(e)})},a.updateAllButtons=function(t){if(void 0!==Votes.userVotes)for(var e=void 0===typeof t&&""!==t?i(t).find(Votes.selectors.button):i(Votes.selectors.button),o=0;o<i(e).length;o++)a.activeButton=i(e)[o],Votes.authenticated&&a.setButtonData(),Votes.authenticated&&a.utilities.isVote(a.data.postid,a.data.site_votes)?(a.buttonFormatter.format(i(a.activeButton),!0),i(a.activeButton).addClass(Votes.cssClasses.active)):(a.buttonFormatter.format(i(a.activeButton),!1),i(a.activeButton).removeClass(Votes.cssClasses.active)),i(a.activeButton).removeClass(Votes.cssClasses.loading),i(a.activeButton).find(Votes.selectors.count).text(a.data.vote_count)},a.setButtonData=function(){a.data.postid=i(a.activeButton).attr("data-postid"),a.data.siteid=i(a.activeButton).attr("data-siteid"),a.data.vote_count=i(a.activeButton).attr("data-votecount"),a.data.site_index=a.utilities.siteIndex(a.data.siteid),a.data.site_votes=Votes.userVotes[a.data.site_index].posts,a.data.vote_count<=0&&(a.data.vote_count=0)},a.bindEvents()},(Votes=Votes||{}).TotalCount=function(){var t=this,r=jQuery;return t.bindEvents=function(){r(document).on("votes-updated-single",function(){t.updateTotal()}),r(document).on("votes-cleared",function(){t.updateTotal()}),r(document).on("votes-user-votes-loaded",function(){t.updateTotal()})},t.updateTotal=function(){for(var t=0;t<r(Votes.selectors.total_votes).length;t++){for(var e=r(Votes.selectors.total_votes)[t],o=parseInt(r(e).attr("data-siteid")),a=r(e).attr("data-posttypes").split(","),i=0,s=0;s<Votes.userVotes.length;s++){var n=Votes.userVotes[s];n.site_id===o&&r.each(n.posts,function(){"all"!==r(e).attr("data-posttypes")?-1!==r.inArray(this.post_type,a)&&i++:i++})}r(e).text(i)}},t.bindEvents()},(Votes=Votes||{}).PostVoteCount=function(){var s=this,c=jQuery;return s.bindEvents=function(){c(document).on("votes-updated-single",function(t,e,o,a,i){if("active"===i)return s.updateCounts();s.decrementSingle(o,a)}),c(document).on("votes-cleared",function(t,e,o){s.updateCounts(o,!0)})},s.updateCounts=function(t,e){void 0!==t&&""!==t||(t=Votes.userVotes),void 0!==e&&""!==e||(e=!1);for(var o=0;o<c("["+Votes.selectors.post_vote_count+"]").length;o++){var a=c("["+Votes.selectors.post_vote_count+"]")[o],i=parseInt(c(a).attr(Votes.selectors.post_vote_count)),s=c(a).attr("data-siteid");""===s&&(s="1");for(var n=0;n<t.length;n++){var r=t[n];r.site_id===parseInt(s)&&c.each(r.posts,function(){if(this.post_id===i){if(e){var t=parseInt(this.total)-1;return void c(a).text(t)}c(a).text(this.total)}})}}},s.decrementSingle=function(t,e){for(var o=0;o<c("["+Votes.selectors.post_vote_count+"]").length;o++){var a=c("["+Votes.selectors.post_vote_count+"]")[o],i=c(a).attr(Votes.selectors.post_vote_count),s=c(a).attr("data-siteid");if(""===s&&(s="1"),s===e&&i===t){var n=parseInt(c(a).text())-1;c(a).text(n)}}},s.bindEvents()},(Votes=Votes||{}).RequireAuthentication=function(){var e=this,o=jQuery;return e.bindEvents=function(){o(document).on("votes-require-authentication",function(){Votes.jsData.dev_mode&&console.log("Unauthenticated user was prevented from voting."),Votes.jsData.authentication_redirect?e.redirect():e.openModal()}),o(document).on("click",".simplevotes-modal-backdrop",function(t){e.closeModal()}),o(document).on("click","["+Votes.selectors.close_modals+"]",function(t){t.preventDefault(),e.closeModal()})},e.redirect=function(){window.location=Votes.jsData.authentication_redirect_url},e.openModal=function(){e.buildModal(),setTimeout(function(){o("["+Votes.selectors.modals+"]").addClass("active")},10)},e.buildModal=function(){if(!(0<o("["+Votes.selectors.modals+"]").length)){var t='<div class="simplevotes-modal-backdrop" '+Votes.selectors.modals+"></div>";t+='<div class="simplevotes-modal-content" '+Votes.selectors.modals+">",t+='<div class="simplevotes-modal-content-body">',t+=Votes.jsData.authentication_modal_content,t+="</div>\x3c!-- .simplevotes-modal-content-body --\x3e",t+="</div>\x3c!-- .simplevotes-modal-content --\x3e",o("body").prepend(t)}},e.closeModal=function(){o("["+Votes.selectors.modals+"]").removeClass("active"),o(document).trigger("votes-modal-closed")},e.bindEvents()},(Votes=Votes||{}).RequireConsent=function(){var i=this,o=jQuery;return i.consentData,i.postData,i.activeButton,i.bindEvents=function(){o(document).on("votes-require-consent",function(t,e,o,a){i.consentData=e,i.postData=o,i.activeButton=a,i.openModal()}),o(document).on("votes-user-consent-approved",function(t,e){if(void 0!==e)return o(i.activeButton).attr("data-user-consent-accepted","true"),o(i.activeButton).click(),void i.closeModal();i.setConsent(!0)}),o(document).on("votes-user-consent-denied",function(){i.setConsent(!1)}),o(document).on("click",".simplevotes-modal-backdrop",function(t){i.closeModal()}),o(document).on("click","[data-votes-consent-deny]",function(t){t.preventDefault(),i.closeModal(),o(document).trigger("votes-user-consent-denied")}),o(document).on("click","[data-votes-consent-accept]",function(t){t.preventDefault(),o(document).trigger("votes-user-consent-approved",[o(this)])})},i.openModal=function(){i.buildModal(),setTimeout(function(){o("["+Votes.selectors.consentModal+"]").addClass("active")},10)},i.buildModal=function(){if(!(0<o("["+Votes.selectors.consentModal+"]").length)){var t='<div class="simplevotes-modal-backdrop" '+Votes.selectors.consentModal+"></div>";t+='<div class="simplevotes-modal-content" '+Votes.selectors.consentModal+">",t+='<div class="simplevotes-modal-content-body no-padding">',t+='<div class="simplevotes-modal-content-interior">',t+=i.consentData.message,t+="</div>",t+='<div class="simplevotes-modal-content-footer">',t+='<button class="simplevotes-button-consent-deny" data-votes-consent-deny>'+i.consentData.deny_text+"</button>",t+='<button class="simplevotes-button-consent-accept" data-votes-consent-accept>'+i.consentData.accept_text+"</button>",t+="</div>\x3c!-- .simplevotes-modal-footer --\x3e",t+="</div>\x3c!-- .simplevotes-modal-content-body --\x3e",t+="</div>\x3c!-- .simplevotes-modal-content --\x3e",o("body").prepend(t)}},i.closeModal=function(){o("["+Votes.selectors.consentModal+"]").removeClass("active")},i.setConsent=function(t){o.ajax({url:Votes.jsData.ajaxurl,type:"post",dataType:"json",data:{action:Votes.formActions.cookieConsent,consent:t}})},i.bindEvents()},jQuery(document).ready(function(){new Votes.Factory}),(Votes=Votes||{}).selectors={button:".simplevote-button",list:".votes-list",clear_button:".simplevotes-clear",total_votes:".simplevotes-user-count",modals:"data-votes-modal",consentModal:"data-votes-consent-modal",close_modals:"data-votes-modal-close",count:".simplevote-button-count",post_vote_count:"data-votes-post-count-id"},Votes.cssClasses={loading:"loading",active:"active"},Votes.jsData={ajaxurl:votes_data.ajaxurl,vote:votes_data.vote,voted:votes_data.voted,include_count:votes_data.includecount,indicate_loading:votes_data.indicate_loading,loading_text:votes_data.loading_text,loading_image_active:votes_data.loading_image_active,loading_image:votes_data.loading_image,cache_enabled:votes_data.cache_enabled,authentication_modal_content:votes_data.authentication_modal_content,authentication_redirect:votes_data.authentication_redirect,authentication_redirect_url:votes_data.authentication_redirect_url,button_options:votes_data.button_options,dev_mode:votes_data.dev_mode,logged_in:votes_data.logged_in,user_id:votes_data.user_id},Votes.userVotes=null,Votes.authenticated=!0,Votes.formActions={votesarray:"votes_array",vote:"votes_vote",clearall:"votes_clear",votelist:"votes_list",cookieConsent:"votes_cookie_consent"},Votes.Factory=function(){jQuery;return this.build=function(){new Votes.UserVotes,new Votes.Lists,new Votes.Clear,new Votes.Button,new Votes.ButtonUpdater,new Votes.TotalCount,new Votes.PostVoteCount,new Votes.RequireAuthentication,new Votes.RequireConsent},this.build()};